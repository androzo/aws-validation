{"format_version":"1.2","terraform_version":"1.5.6","variables":{"account_number":{"value":"396608777381"},"environment":{"value":"devl"},"region":{"value":"sa-east-1"},"team_name":{"value":"team-drozer"}},"planned_values":{"root_module":{"resources":[{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}}},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"sensitive_values":{}}]}},"resource_changes":[{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"}},"after":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl"}},"after_unknown":{},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"after":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"after_unknown":{},"before_sensitive":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}},"after_sensitive":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}}}},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"after":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"after_unknown":{},"before_sensitive":{},"after_sensitive":{}}}],"prior_state":{"format_version":"1.0","terraform_version":"1.5.6","values":{"root_module":{"resources":[{"address":"data.aws_iam_policy.permissions_boundary","mode":"data","type":"aws_iam_policy","name":"permissions_boundary","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","attachment_count":0,"description":"Permissions boundary for deployment role","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","name":"team-drozer-deployment-permission-boundary","path":"/","path_prefix":null,"policy":"{\"Statement\":[{\"Action\":\"*\",\"Condition\":{\"StringNotEquals\":{\"aws:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Deny\",\"Resource\":\"*\"},{\"Action\":[\"iam:Delete*\",\"iam:UpdateAssumeRolePolicy\",\"iam:PutRolePermissionsBoundary\",\"organizations:*\",\"account:*\"],\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"DenyDangerousActions\"},{\"Action\":\"iam:PassRole\",\"Condition\":{\"ArnNotLikeIfExists\":{\"aws:PrincipalArn\":\"arn:aws:iam::*:role/team-drozer-deployment-role\"},\"StringNotLike\":{\"iam:PassedToService\":[\"ec2.amazonaws.com\",\"lambda.amazonaws.com\",\"ecs-tasks.amazonaws.com\"]}},\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"ConditionalPassRole\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSS6LNBGNRUX","tags":{"Name":"team-drozer-deployment-permission-boundary","team":"devops"}},"sensitive_values":{"tags":{}}},{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}},"depends_on":["data.aws_iam_policy.permissions_boundary"]},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"sensitive_values":{},"depends_on":["aws_iam_policy.deployment_policy","aws_iam_role.deployment_role","data.aws_iam_policy.permissions_boundary"]}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws"}},"root_module":{"resources":[{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_config_key":"aws","expressions":{"description":{"references":["var.team_name"]},"name":{"references":["var.team_name"]},"policy":{"references":["var.team_name","var.team_name"]},"tags":{"references":["var.team_name","var.environment"]}},"schema_version":0},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["var.account_number","var.team_name","var.environment"]},"name":{"references":["var.team_name"]},"permissions_boundary":{"references":["data.aws_iam_policy.permissions_boundary.arn","data.aws_iam_policy.permissions_boundary"]},"tags":{"references":["var.team_name","var.environment"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.deployment_policy.arn","aws_iam_policy.deployment_policy"]},"role":{"references":["aws_iam_role.deployment_role.name","aws_iam_role.deployment_role"]}},"schema_version":0,"depends_on":["aws_iam_policy.deployment_policy","aws_iam_role.deployment_role"]},{"address":"data.aws_iam_policy.permissions_boundary","mode":"data","type":"aws_iam_policy","name":"permissions_boundary","provider_config_key":"aws","expressions":{"arn":{"references":["var.account_number","var.team_name"]}},"schema_version":0}],"variables":{"account_number":{},"environment":{},"region":{},"team_name":{}}}},"relevant_attributes":[{"resource":"data.aws_iam_policy.permissions_boundary","attribute":["arn"]}],"timestamp":"2025-04-13T16:19:41Z"}
::debug::Terraform exited with code 0.
::debug::stdout: {"format_version":"1.2","terraform_version":"1.5.6","variables":{"account_number":{"value":"396608777381"},"environment":{"value":"devl"},"region":{"value":"sa-east-1"},"team_name":{"value":"team-drozer"}},"planned_values":{"root_module":{"resources":[{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}}},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"sensitive_values":{}}]}},"resource_changes":[{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"}},"after":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl"}},"after_unknown":{},"before_sensitive":{"tags":{},"tags_all":{}},"after_sensitive":{"tags":{},"tags_all":{}}}},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["update"],"before":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"after":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"after_unknown":{},"before_sensitive":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}},"after_sensitive":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}}}},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["no-op"],"before":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"after":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"after_unknown":{},"before_sensitive":{},"after_sensitive":{}}}],"prior_state":{"format_version":"1.0","terraform_version":"1.5.6","values":{"root_module":{"resources":[{"address":"data.aws_iam_policy.permissions_boundary","mode":"data","type":"aws_iam_policy","name":"permissions_boundary","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","attachment_count":0,"description":"Permissions boundary for deployment role","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","name":"team-drozer-deployment-permission-boundary","path":"/","path_prefix":null,"policy":"{\"Statement\":[{\"Action\":\"*\",\"Condition\":{\"StringNotEquals\":{\"aws:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Deny\",\"Resource\":\"*\"},{\"Action\":[\"iam:Delete*\",\"iam:UpdateAssumeRolePolicy\",\"iam:PutRolePermissionsBoundary\",\"organizations:*\",\"account:*\"],\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"DenyDangerousActions\"},{\"Action\":\"iam:PassRole\",\"Condition\":{\"ArnNotLikeIfExists\":{\"aws:PrincipalArn\":\"arn:aws:iam::*:role/team-drozer-deployment-role\"},\"StringNotLike\":{\"iam:PassedToService\":[\"ec2.amazonaws.com\",\"lambda.amazonaws.com\",\"ecs-tasks.amazonaws.com\"]}},\"Effect\":\"Deny\",\"Resource\":\"*\",\"Sid\":\"ConditionalPassRole\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSS6LNBGNRUX","tags":{"Name":"team-drozer-deployment-permission-boundary","team":"devops"}},"sensitive_values":{"tags":{}}},{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","attachment_count":1,"description":"Policy granting access to resources tagged with Team=team-drozer","id":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","name":"team-drozer-deployment-policy","name_prefix":"","path":"/","policy":"{\"Statement\":[{\"Action\":\"s3:*\",\"Condition\":{\"StringEquals\":{\"aws:RequestTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"},{\"Action\":\"s3:ListBucket\",\"Condition\":{\"StringEquals\":{\"s3:ResourceTag/team\":\"team-drozer\"}},\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}","policy_id":"ANPAVYV5ZVSSYENUTI2DN","tags":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-policy","environment":"devl","team":"devops"}},"sensitive_values":{"tags":{},"tags_all":{}}},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"arn":"arn:aws:iam::396608777381:role/team-drozer-deployment-role","assume_role_policy":"{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"token.actions.githubusercontent.com:aud\":\"sts.amazonaws.com\"},\"StringLike\":{\"token.actions.githubusercontent.com:sub\":\"repo:androzo/team-drozer-*:*devl\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::396608777381:oidc-provider/token.actions.githubusercontent.com\"}}],\"Version\":\"2012-10-17\"}","create_date":"2025-04-12T21:09:06Z","description":"","force_detach_policies":false,"id":"team-drozer-deployment-role","inline_policy":[],"managed_policy_arns":["arn:aws:iam::396608777381:policy/team-drozer-deployment-policy"],"max_session_duration":3600,"name":"team-drozer-deployment-role","name_prefix":"","path":"/","permissions_boundary":"arn:aws:iam::396608777381:policy/team-drozer-deployment-permission-boundary","tags":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"tags_all":{"Name":"team-drozer-deployment-role","environment":"devl","team":"devops"},"unique_id":"AROAVYV5ZVSSU3XEQINAO"},"sensitive_values":{"inline_policy":[],"managed_policy_arns":[false],"tags":{},"tags_all":{}},"depends_on":["data.aws_iam_policy.permissions_boundary"]},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"team-drozer-deployment-role-20250412210906844900000001","policy_arn":"arn:aws:iam::396608777381:policy/team-drozer-deployment-policy","role":"team-drozer-deployment-role"},"sensitive_values":{},"depends_on":["aws_iam_policy.deployment_policy","aws_iam_role.deployment_role","data.aws_iam_policy.permissions_boundary"]}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws"}},"root_module":{"resources":[{"address":"aws_iam_policy.deployment_policy","mode":"managed","type":"aws_iam_policy","name":"deployment_policy","provider_config_key":"aws","expressions":{"description":{"references":["var.team_name"]},"name":{"references":["var.team_name"]},"policy":{"references":["var.team_name","var.team_name"]},"tags":{"references":["var.team_name","var.environment"]}},"schema_version":0},{"address":"aws_iam_role.deployment_role","mode":"managed","type":"aws_iam_role","name":"deployment_role","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["var.account_number","var.team_name","var.environment"]},"name":{"references":["var.team_name"]},"permissions_boundary":{"references":["data.aws_iam_policy.permissions_boundary.arn","data.aws_iam_policy.permissions_boundary"]},"tags":{"references":["var.team_name","var.environment"]}},"schema_version":0},{"address":"aws_iam_role_policy_attachment.attach_deployment_policy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"attach_deployment_policy","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.deployment_policy.arn","aws_iam_policy.deployment_policy"]},"role":{"references":["aws_iam_role.deployment_role.name","aws_iam_role.deployment_role"]}},"schema_version":0,"depends_on":["aws_iam_policy.deployment_policy","aws_iam_role.deployment_role"]},{"address":"data.aws_iam_policy.permissions_boundary","mode":"data","type":"aws_iam_policy","name":"permissions_boundary","provider_config_key":"aws","expressions":{"arn":{"references":["var.account_number","var.team_name"]}},"schema_version":0}],"variables":{"account_number":{},"environment":{},"region":{},"team_name":{}}}},"relevant_attributes":[{"resource":"data.aws_iam_policy.permissions_boundary","attribute":["arn"]}],"timestamp":"2025-04-13T16:19:41Z"}